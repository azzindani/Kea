# Tool Dependencies Configuration
# JIT (Just-In-Time) installation with uv

jit:
  enabled: true
  package_manager: "uv"  # or "pip"
  fallback_to_pip: true  # If uv not available
  cache_installed: true  # Remember what's installed

# Tool categories and their dependencies
tools:
  # Data extraction
  pdf_extract:
    packages: ["pymupdf", "pdfplumber"]
    optional: ["pdf2image", "pytesseract"]
    
  ocr:
    packages: ["pytesseract", "pillow"]
    optional: ["easyocr"]
    gpu_packages: ["easyocr"]  # Use if GPU available
    
  # Web scraping  
  web_scrape:
    packages: ["beautifulsoup4", "lxml", "httpx"]
    optional: ["playwright"]
    heavy: true  # Playwright is heavy, load only when needed
    
  browser:
    packages: ["playwright"]
    post_install: "playwright install chromium"
    heavy: true
    
  # Data analysis
  analytics:
    packages: ["pandas", "numpy", "scipy"]
    optional: ["statsmodels"]
    
  visualization:
    packages: ["plotly", "matplotlib"]
    optional: ["seaborn", "altair"]
    
  # Machine learning
  ml_basic:
    packages: ["scikit-learn"]
    optional: ["xgboost", "lightgbm"]
    
  ml_advanced:
    packages: ["scikit-learn", "xgboost", "lightgbm"]
    optional: ["catboost"]
    heavy: true
    
  # NLP
  nlp_basic:
    packages: ["nltk"]
    post_install: "python -c \"import nltk; nltk.download('punkt', quiet=True)\""
    
  nlp_advanced:
    packages: ["spacy"]
    post_install: "python -m spacy download en_core_web_sm"
    heavy: true
    
  # Database
  database:
    packages: ["duckdb", "sqlalchemy"]
    optional: ["asyncpg", "aiosqlite"]
    
  # API clients
  finance:
    packages: ["yfinance"]
    optional: ["alpha-vantage", "polygon-api"]
    
  academic:
    packages: ["arxiv", "biopython"]
    optional: ["semanticscholar"]

# Server-level dependencies (always installed for that server)
servers:
  analytics_server:
    tools: ["analytics", "visualization"]
    
  ml_server:
    tools: ["analytics", "ml_basic"]
    optional_tools: ["ml_advanced"]
    
  data_sources_server:
    tools: ["web_scrape", "finance"]
    optional_tools: ["browser"]
    
  academic_server:
    tools: ["academic"]
    
  qualitative_server:
    tools: ["nlp_basic"]
    optional_tools: ["nlp_advanced"]

# Isolation settings
isolation:
  enabled: true
  method: "process"  # "process" or "venv"
  
  # Tools that MUST run in isolation (have conflicting deps)
  isolated_tools:
    - "nlp_advanced"  # spacy conflicts with some packages
    - "ml_advanced"   # catboost has specific requirements
    
  # Tools that can share environment
  shared_tools:
    - "analytics"
    - "visualization"
    - "database"
